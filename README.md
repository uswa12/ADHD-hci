# FocusFlow

FocusFlow is a lightweight ADHD-friendly study assistant built with Flask. It estimates focus from head pose (OpenCV + MediaPipe), streams feedback to a single-page UI, and offers a voice-enabled buddy for task planning, nudges, and accessibility toggles. Everything runs locally; no cloud services are required.

## Key Capabilities
- Real-time focus estimation from the webcam; MJPEG stream exposed at `/video_feed`.
- Live analytics: deep-focus score, distraction counts, consistency, and peak insight window.
- Task and schedule helper with autogenerated subtasks, timers, and dopamine-break suggestions.
- Voice commands to toggle camera/mic, add/remove tasks, schedule items, change accessibility settings, and navigate sections.
- Accessibility controls: dyslexia font, dark mode, color contrast levels, color-blind mode, sidebar visibility, language selection.
- Local persistence of settings/analytics to `focusflow_state.json` (tasks reset each run by design).

## Stack
- Python 3.10+
- Flask for the API/server
- OpenCV + MediaPipe Pose for head-pose based focus estimation
- Single-page UI in `templates/index.html`

## Quick Start
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r Requirements.txt
python app.py  # defaults to port 5000
```
Open http://localhost:5000 and allow camera access in your browser. If port 5000 is taken, stop the conflicting process (e.g., `lsof -i :5000` on macOS) or change the port in `app.py`.

## Configuration & Operation
- Webcam: Required for focus tracking; the app degrades gracefully if OpenCV/MediaPipe are unavailable.
- Persistence: Settings and analytics are stored in `focusflow_state.json`. Tasks/schedules are in-memory per session.
- Threads: `camera_loop()` and `dopamine_suggester()` run in background threads; stopping the server (Ctrl+C) halts them.
- Voice commands: Sent to `/api/voice_command`; responses include an action payload for the UI to apply (camera toggle, task CRUD, settings change, navigation, etc.).

## API Surface (high level)
- `GET /` — Serve SPA.
- `GET /video_feed` — MJPEG webcam stream with focus overlay.
- `GET /api/state` — Current focus score, toggles, tasks, analytics, settings.
- `GET /api/analytics` — Live analytics snapshot.
- `GET /api/ai_insight` — Derived insight + scheduling suggestion.
- `POST /api/voice_command` — Voice intent handling.
- `POST /api/add_task`, `POST /api/toggle_subtask`, `POST /api/remove_task`, `DELETE /api/task/<id>` — Task CRUD.
- `GET /api/schedule` — Suggested schedule and daily stats.
- `POST /api/settings` — Update accessibility/settings.

## Project Layout
- `app.py` — Flask app, focus logic, APIs, background workers.
- `templates/index.html` — Single-page UI (dashboard, tasks, analytics, settings, buddy panel).
- `focusflow_state.json` — Persisted settings + analytics snapshot.
- `Requirements.txt` — Python dependencies.
- `ARCHITECTURE.md` — Deeper runtime/flow details.

## Troubleshooting
- **Port in use**: `lsof -i :5000` to find and stop the process, or change the port in `app.py`.
- **Camera not working**: ensure OpenCV/MediaPipe installed, grant camera permission, and close other apps using the webcam.
- **Slow installs on Apple Silicon**: prefer prebuilt `opencv-python` wheels; avoid building from source.

## License
MIT (see repository root if present).
